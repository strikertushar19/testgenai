<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Repository Fetch</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 10px 0; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        input { width: 100%; padding: 8px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Repository Fetch</h1>
        
        <div class="test-section info">
            <h3>üìã Instructions</h3>
            <p>This page tests the repository fetching functionality. Enter a GitHub repository URL and click "Test Fetch" to see if it works.</p>
            <p><strong>Note:</strong> Due to CORS restrictions, this might not work from localhost. Try deploying to Vercel for full functionality.</p>
        </div>

        <div class="test-section">
            <h3>üîó Test Repository Fetch</h3>
            <input type="text" id="repoUrl" placeholder="https://github.com/facebook/react" value="https://github.com/facebook/react">
            <br>
            <button onclick="testRepositoryFetch()">Test Fetch Repository</button>
            <div id="result"></div>
        </div>

        <div class="test-section">
            <h3>üåê Test GitHub API Direct</h3>
            <button onclick="testGitHubAPI()">Test GitHub API Direct</button>
            <div id="apiResult"></div>
        </div>
    </div>

    <script>
        async function testRepositoryFetch() {
            const resultDiv = document.getElementById('result');
            const repoUrl = document.getElementById('repoUrl').value;
            
            resultDiv.innerHTML = '<p>üîÑ Testing repository fetch...</p>';
            
            try {
                // Test the repository fetching logic
                const response = await fetch(`https://api.github.com/repos/facebook/react`, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'TestGen-AI/1.0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
                }
                
                const repoData = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Repository Fetch Successful!</h4>
                        <p><strong>Repository:</strong> ${repoData.full_name}</p>
                        <p><strong>Description:</strong> ${repoData.description}</p>
                        <p><strong>Default Branch:</strong> ${repoData.default_branch}</p>
                        <p><strong>Stars:</strong> ${repoData.stargazers_count}</p>
                        <p><strong>Language:</strong> ${repoData.language}</p>
                        <p><strong>Size:</strong> ${repoData.size} KB</p>
                    </div>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Repository Fetch Failed</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Possible causes:</strong></p>
                        <ul>
                            <li>CORS restrictions (try deploying to Vercel)</li>
                            <li>Invalid repository URL</li>
                            <li>Repository is private</li>
                            <li>GitHub API rate limit exceeded</li>
                        </ul>
                    </div>
                `;
            }
        }

        async function testGitHubAPI() {
            const resultDiv = document.getElementById('apiResult');
            resultDiv.innerHTML = '<p>üîÑ Testing GitHub API...</p>';
            
            try {
                // Test basic GitHub API access
                const response = await fetch('https://api.github.com/repos/facebook/react', {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'TestGen-AI/1.0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ GitHub API Access Successful!</h4>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Repository:</strong> ${data.full_name}</p>
                        <p><strong>Public:</strong> ${data.private ? 'No' : 'Yes'}</p>
                        <pre>${JSON.stringify(data, null, 2).substring(0, 500)}...</pre>
                    </div>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå GitHub API Test Failed</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p>This indicates a CORS or network issue. The application will work better when deployed to Vercel.</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
